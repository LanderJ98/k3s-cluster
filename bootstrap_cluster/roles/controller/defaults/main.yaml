ansible_user: root
server_init_args: >-
  {% if groups['controller'] | length > 1 %}
    {% if ansible_host == groups['controller'][0] %}
      --cluster-init
      --write-kubeconfig-mode 644
      --node-ip {{ controller_1_private_ip }}
      --advertise-address {{ controller_1_private_ip }}
    {% else %}
      --server https://{{ kube_api_lb_ip }}:6443
      --node-ip {{ controller_2_private_ip }}
      --advertise-address {{ controller_2_private_ip }}
    {% endif %}
    --token {{ k3s_token }}
  {% endif %}
  {{ extra_server_args | default('') }}